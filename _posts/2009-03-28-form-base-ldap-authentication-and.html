---
title: Programming form base ldap authentication and authorization
author: bloggerming
tags:
- programming
modified_time: '2015-12-03T06:15:27.693-08:00'
blogger_id: tag:blogger.com,1999:blog-3711184356900467447.post-1597971214029949000
blogger_orig_url: http://technoming.blogspot.com/2009/03/form-base-ldap-authentication-and.html
---

using tomcat to connect to ldap<br />edit server.xml<br />&lt;Realm  className="org.apache.catalina.realm.JNDIRealm"<br />debug="99"<br />connectionName="cn=root"<br />connectionPassword="idsldap"<br />connectionURL="ldap://<a href="http://192.168.12.93:1389/">192.168.12.93:1389/</a>"<br />roleBase="roid=210,cn=allroles,cn=210,O=mycompany"<br />roleName="roid"<br />roleSearch="(member={0})"<br />roleSubtree="false"<br />userSearch="(uid={0})"<br />userPassword="userPassword"<br />userPattern="uid={0},oid=2005,oid=0107,cn=210,O=mycompany"<br />/&gt;<br /><br />add  context if need be<br />&lt;Context  docBase="C:/eclipse/wtp-all-in-one-sdk-R-1.5.4-win32/eclipse/workspace/webtest/WebContent"  path="/webtest" reloadable="true" /&gt;<br /><br />edit web app web.xml for security  context<br />&lt;taglib&gt;<br />&lt;taglib-uri&gt;<a href="http://jakarta.apache.org/taglibs/session-1.0">http://jakarta.apache.org/taglibs/session-1.0</a>&lt;/taglib-uri&gt;<br />&lt;taglib-location&gt;/WEB-INF/taglibs-session.tld&lt;/taglib-location&gt;<br />&lt;/taglib&gt;<br /><br />&lt;taglib&gt;<br />&lt;taglib-uri&gt;<a href="http://jakarta.apache.org/taglibs/request-1.0">http://jakarta.apache.org/taglibs/request-1.0</a>&lt;/taglib-uri&gt;<br />&lt;taglib-location&gt;/WEB-INF/taglibs-request.tld&lt;/taglib-location&gt;<br />&lt;/taglib&gt;<br /><br />&lt;security-constraint&gt;<br />&lt;web-resource-collection&gt;<br />&lt;web-resource-name&gt;Public  Area&lt;/web-resource-name&gt;<br />&lt;!-- Define the context-relative  URL(s) to be protected --&gt;<br />&lt;url-pattern&gt;/index.jsp&lt;/url-pattern&gt;<br />&lt;url-pattern&gt;/login.jsp&lt;/url-pattern&gt;<br />&lt;/web-resource-collection&gt;<br />&lt;/security-constraint&gt;<br /><br />&lt;security-constraint&gt;<br />&lt;web-resource-collection&gt;<br />&lt;web-resource-name&gt;Protected  Area&lt;/web-resource-name&gt;<br />&lt;!-- Define the context-relative  URL(s) to be protected --&gt;<br />&lt;url-pattern&gt;/securepage.jsp&lt;/url-pattern&gt;<br />&lt;/web-resource-collection&gt;<br />&lt;auth-constraint&gt;<br />&lt;!--  Anyone with one of the listed roles may access this area --&gt;<br />&lt;role-name&gt;20014&lt;/role-name&gt;<br />&lt;role-name&gt;20011&lt;/role-name&gt;<br />&lt;role-name&gt;Admin  Users&lt;/role-name&gt;<br />&lt;/auth-constraint&gt;<br />&lt;/security-constraint&gt;<br /><br />&lt;!--  uses  form-based authentication --&gt;<br />&lt;login-config&gt;<br />&lt;auth-method&gt;FORM&lt;/auth-method&gt;<br />&lt;form-login-config&gt;<br />&lt;form-login-page&gt;/login.jsp&lt;/form-login-page&gt;<br />&lt;form-error-page&gt;/fail_login.html&lt;/form-error-page&gt;<br />&lt;/form-login-config&gt;<br />&lt;/login-config&gt;<br /><br />&lt;!-- Security  roles referenced by this web application --&gt;<br />&lt;security-role&gt;<br />&lt;role-name&gt;20014&lt;/role-name&gt;<br />&lt;/security-role&gt;<br />&lt;security-role&gt;<br />&lt;role-name&gt;20011&lt;/role-name&gt;<br />&lt;/security-role&gt;<br />&lt;security-role&gt;<br />&lt;role-name&gt;Admin  Users&lt;/role-name&gt;<br />&lt;/security-role&gt;<br /><br />create  login.jsp<br />&lt;%@ page language="java" contentType="text/html;  charset=BIG5"<br />pageEncoding="BIG5"%&gt;<br />&lt;!DOCTYPE html PUBLIC  "-//W3C//DTD HTML 4.01 Transitional//EN"  "<a href="http://www.w3.org/TR/html4/loose.dtd">http://www.w3.org/TR/html4/loose.dtd</a>"&gt;<br />&lt;html&gt;<br />&lt;head&gt;<br />&lt;meta  http-equiv="Content-Type" content="text/html;  charset=BIG5"&gt;<br />&lt;title&gt;Insert title  here&lt;/title&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />&lt;form method="POST"  action="j_security_check"&gt;<br />&lt;input type="text"  name="j_username"&gt;<br />&lt;br&gt;<br />&lt;input type="password"  name="j_password"&gt;<br />&lt;br&gt;<br />&lt;input  type="submit"&gt;<br />&lt;/form&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br />create  securepage.jsp<br />&lt;%@ page language="java" contentType="text/html;  charset=BIG5"<br />pageEncoding="BIG5"%&gt;<br />&lt;!DOCTYPE html PUBLIC  "-//W3C//DTD HTML 4.01 Transitional//EN"  "<a href="http://www.w3.org/TR/html4/loose.dtd">http://www.w3.org/TR/html4/loose.dtd</a>"&gt;<br />&lt;%@ taglib  uri="<a href="http://jakarta.apache.org/taglibs/session-1.0">http://jakarta.apache.org/taglibs/session-1.0</a>" prefix="sess"  %&gt;<br />&lt;%@ taglib uri="<a href="http://jakarta.apache.org/taglibs/request-1.0">http://jakarta.apache.org/taglibs/request-1.0</a>"  prefix="req" %&gt;<br />&lt;html&gt;<br />&lt;head&gt;<br />&lt;meta  http-equiv="Content-Type" content="text/html;  charset=BIG5"&gt;<br />&lt;title&gt;Insert title  here&lt;/title&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />secure  page<br />&lt;req:isUserInRole role="20014"&gt;<br />The remote user is in role  "20014".&lt;br  /&gt;<br />&lt;/req:isUserInRole&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br />create  logout.jsp<br />&lt;%@ page language="java" contentType="text/html;  charset=BIG5"<br />pageEncoding="BIG5"%&gt;<br />&lt;!DOCTYPE html PUBLIC  "-//W3C//DTD HTML 4.01 Transitional//EN"  "<a href="http://www.w3.org/TR/html4/loose.dtd">http://www.w3.org/TR/html4/loose.dtd</a>"&gt;<br />&lt;%@ taglib  uri="<a href="http://jakarta.apache.org/taglibs/session-1.0">http://jakarta.apache.org/taglibs/session-1.0</a>" prefix="sess"  %&gt;<br />&lt;%@ taglib uri="<a href="http://jakarta.apache.org/taglibs/request-1.0">http://jakarta.apache.org/taglibs/request-1.0</a>"  prefix="req" %&gt;<br /><br />&lt;html&gt;<br />&lt;head&gt;<br />&lt;meta  http-equiv="Content-Type" content="text/html;  charset=BIG5"&gt;<br />&lt;title&gt;Insert title  here&lt;/title&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br /><br />&lt;sess:invalidate/&gt;<br />You are now logged out&lt;br&gt;<br />&lt;a href="index.jsp"&gt;Return to  index&lt;/a&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br />try to access  securepage.jsp will be redirected to login.jsp<br /><br />check catalina for  messages<br />2007-06-15 11:08:39 JNDIRealm[Standalone]: Username 69001  successfully authenticated<br />2007-06-15 11:08:39 JNDIRealm[Standalone]:    getRoles(uid=69001,oid=2005,oid=0107,cn=210,O=mycompany)<br />2007-06-15 11:08:39  JNDIRealm[Standalone]:   Searching role base  'roid=010,cn=allroles,cn=010,O=ESUN' for attribute 'roid'<br />2007-06-15 11:08:39  JNDIRealm[Standalone]:   With filter expression  '(member=uid=69001,oid=2005,oid=0107,cn=210,O=mycompany)'<br />2007-06-15 11:08:39  JNDIRealm[Standalone]:   retrieving values for attribute roid<br />2007-06-15  11:08:39 JNDIRealm[Standalone]:   Returning 1 roles<br />2007-06-15 11:08:39  JNDIRealm[Standalone]:   Found role 20014<br />2007-06-15 11:08:39  JNDIRealm[Standalone]: Username 69001 has role 20014